library(devtools)
devtools::install("C:/Users/kastr/OneDrive/Arbejde/kalman_package/CESKalman")
library(CESKalman)
plot(Estimation)
plot.CESKalman(Estimation)
plot(Estimation)
library(CESKalman)
plot(Estimation)
?plot.CESKalman
??plot.CESKalman
knitr::opts_chunk$set(echo = TRUE)
## Installing the package
library(devtools)
devtools::install("C:/Users/kastr/OneDrive/Arbejde/kalman_package/CESKalman")
library(CESKalman)
## See ?Load_Data for available countries
US = Load_Data(Country="USA",tstart=1970,tend=2017)
US = ts(US,start=1970,end=2017,freq=1)
par(mfrow=c(3,2),mar=c(2,2,2,2))
plot(US[,'q'],main="",ylab="User cost of capital",xlab="")
par(new = TRUE)
plot(US[,'w'],type="h",axes=F,ylab="Hourly wage",xlab="",lty=1)
axis(4)
plot(US[,'K'],main="Capital stock",ylab="",xlab="")
plot(US[,'L'],main="Labor in hours",ylab="",xlab="")
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="",xlab="")
plot(US[,"K"]/US[,"L"],main="K/L-ratio",ylab="",xlab="")
## See ?Load_Data for available countries
US = Load_Data(Country="USA",tstart=1970,tend=2017)
US = ts(US,start=1970,end=2017,freq=1)
par(mfrow=c(3,2),mar=c(2,4,2,4))
plot(US[,'q'],main="",ylab="User cost of capital",xlab="")
par(new = TRUE)
plot(US[,'w'],type="h",axes=F,ylab="Hourly wage",xlab="",lty=1)
axis(4)
plot(US[,'K'],main="Capital stock",ylab="",xlab="")
plot(US[,'L'],main="Labor in hours",ylab="",xlab="")
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="",xlab="")
plot(US[,"K"]/US[,"L"],main="K/L-ratio",ylab="",xlab="")
plot(US[,'q'],main="Prices",ylab="User cost of capital",xlab="")
par(new = TRUE)
plot(US[,'w'],type="h",axes=F,ylab="",xlab="",lty=1)
mtext("right y axis", side=4, line=-1.5)
plot(US[,'q'],main="Prices",ylab="User cost of capital",xlab="")
par(new = TRUE)
plot(US[,'w'],type="h",axes=F,ylab="",xlab="",lty=1)
mtext("right y axis", side=4, line=2)
par(mfrow=c(3,2),mar=c(2,4,2,4))
plot(US[,'q'],main="Prices",ylab="User cost of capital",xlab="")
par(new = TRUE)
plot(US[,'w'],type="h",axes=F,ylab="",xlab="",lty=1)
mtext("right y axis", side=4, line=1)
par(mfrow=c(3,2),mar=c(2,4,2,4))
plot(US[,'q'],main="Prices",ylab="User cost of capital",xlab="")
par(new = TRUE)
plot(US[,'w'],type="h",axes=F,ylab="",xlab="",lty=1)
mtext("right y axis", side=4, line=1,cex=0.8)
plot(US[,'q'],main="Prices",ylab="User cost of capital",xlab="")
par(new = TRUE)
plot(US[,'w'],type="h",axes=F,ylab="",xlab="",lty=1)
mtext("right y axis", side=4, line=2,cex=0.8)
par(mfrow=c(3,2),mar=c(2,4,2,4))
plot(US[,'q'],main="Prices",ylab="User cost of capital",xlab="")
par(new = TRUE)
plot(US[,'w'],type="l",axes=F,ylab="",xlab="",lty=1)
mtext("right y axis", side=4, line=2,cex=0.8)
## See ?Load_Data for available countries
US = Load_Data(Country="USA",tstart=1970,tend=2017)
US = ts(US,start=1970,end=2017,freq=1)
par(mfrow=c(3,2),mar=c(2,4,2,4))
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="",xlab="")
plot(US[,"K"]/US[,"L"],main="K/L-ratio",ylab="",xlab="")
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="",xlab="")
par(new = TRUE)
plot(diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2)
axis(4)
abline(h=0,col="grey40")
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="",xlab="",lwd=2)
par(new = TRUE)
plot(diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
mtext("Growth rate, %", side=4, line=2)
par(mfrow=c(3,2),mar=c(2,4,2,4))
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
mtext("Growth rate, %", side=4, line=2)
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
mtext("Growth rate, %", side=4, line=2,cex=0.5)
par(mfrow=c(3,2),mar=c(2,4,2,4))
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
mtext("Growth rate, %", side=4, line=2,cex=0.5)
par(mfrow=c(3,2),mar=c(2,4,2,4))
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
mtext("Growth rate, %", side=4, line=2,cex=0.8)
par(mfrow=c(3,2),mar=c(2,4,2,4))
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
mtext("Growth rate, %", side=4, line=2,cex=0.7)
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2,line=2,cex=0.7)
par(new = TRUE)
plot(diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
mtext("Growth rate, %", side=4, line=2,cex=0.7)
par(mfrow=c(3,2),mar=c(2,4,2,4))
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2,cex.yaxis=0.7)
par(new = TRUE)
plot(diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
mtext("Growth rate, %", side=4, line=2,cex=0.7)
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2,cex.ylab=0.7)
par(new = TRUE)
plot(diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
mtext("Growth rate, %", side=4, line=2,cex=0.7)
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
mtext("Growth rate, %", side=4, line=2,cex=0.7)
## See ?Load_Data for available countries
US = Load_Data(Country="USA",tstart=1970,tend=2017)
US = ts(US,start=1970,end=2017,freq=1)
par(mfrow=c(3,2),mar=c(2,4,2,4),cex.ylab)
par(mfrow=c(3,2),mar=c(2,4,2,4))
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
mtext("Growth rate, %", side=4, line=2,cex=0.7)
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
mtext("Growth rate, %", side=4, line=2.5,cex=0.7)
par(mfrow=c(3,2),mar=c(2,4,2,4))
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
mtext("Growth rate, %", side=4, line=2.5,cex=0.7)
par(mfrow=c(3,2),mar=c(2,4,2,4))
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(100*diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
mtext("Growth rate, %", side=4, line=2.5,cex=0.7)
legend("topright",legend=c("Level","Growth rate, rhs"),lty=c(1,2),lwd=2)
par(mfrow=c(3,2),mar=c(2,4,2,4))
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(100*diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
mtext("Growth rate, %", side=4, line=2.5,cex=0.7)
legend("topright",legend=c("Level","Growth rate, rhs"),lty=c(1,2),lwd=2,bty="n")
par(mfrow=c(2,2),mar=c(2,4,2,4))
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(100*diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
mtext("Growth rate, %", side=4, line=2.5,cex=0.7)
legend("topright",legend=c("Level","Growth rate, rhs"),lty=c(1,2),lwd=2,bty="n")
plot(US[,'K']/US[,'L'],main="K/L-ratio",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(100*diff(log(US[,'K']/US[,'L'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
mtext("Growth rate, %", side=4, line=2.5,cex=0.7)
legend("topright",legend=c("Level","Growth rate, rhs"),lty=c(1,2),lwd=2,bty="n")
## See ?Load_Data for available countries
US = Load_Data(Country="USA",tstart=1970,tend=2017)
US = ts(US,start=1970,end=2017,freq=1)
par(mfrow=c(2,2),mar=c(2,4,2,4))
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(100*diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
abline(mean(100*diff(log(US[,'q']/US[,'w']))),lty=2)
par(mfrow=c(2,2),mar=c(2,4,2,4))
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(100*diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
abline(h=mean(100*diff(log(US[,'q']/US[,'w']))),lty=2)
mtext("Growth rate, %", side=4, line=2.5,cex=0.7)
legend("topright",legend=c("Level","Growth rate, rhs"),lty=c(1,2),lwd=2,bty="n")
plot(US[,'K']/US[,'L'],main="K/L-ratio",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(100*diff(log(US[,'K']/US[,'L'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
abline(h=mean(100*diff(log(US[,'K']/US[,'L']))),lty=2)
mtext("Growth rate, %", side=4, line=2.5,cex=0.7)
legend("topright",legend=c("Level","Growth rate, rhs"),lty=c(1,2),lwd=2,bty="n")
par(mfrow=c(2,2),mar=c(2,4,2,4))
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(100*diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
abline(h=mean(100*diff(log(US[,'q']/US[,'w']))),lty=2)
mtext("Growth rate, %", side=4, line=2.5,cex=0.7)
legend("topright",legend=c("Level","Growth rate, rhs"),lty=c(1,2),lwd=2,bty="n")
plot(US[,'K']/US[,'L'],main="K/L-ratio",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(100*diff(log(US[,'K']/US[,'L'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
abline(h=mean(100*diff(log(US[,'K']/US[,'L']))),lty=2)
mtext("Growth rate, %", side=4, line=2.5,cex=0.7)
legend("topright",legend=c("Level","Growth rate, rhs"),lty=c(1,2),lwd=2,bty="n")
plot(US[,'q_GDP']/US[,'K'],main="Capital productivity, Y/K",ylab="Level",xlab="",lwd=2)
US
par(mfrow=c(2,2),mar=c(2,4,2,4))
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(100*diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
abline(h=mean(100*diff(log(US[,'q']/US[,'w']))),lty=2)
mtext("Growth rate, %", side=4, line=2.5,cex=0.7)
legend("topright",legend=c("Level","Growth rate, rhs"),lty=c(1,2),lwd=2,bty="n")
plot(US[,'K']/US[,'L'],main="K/L-ratio",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(100*diff(log(US[,'K']/US[,'L'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
abline(h=mean(100*diff(log(US[,'K']/US[,'L']))),lty=2)
mtext("Growth rate, %", side=4, line=2.5,cex=0.7)
legend("topright",legend=c("Level","Growth rate, rhs"),lty=c(1,2),lwd=2,bty="n")
plot(US[,'q_gdp']/US[,'K'],main="Capital productivity, Y/K",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(100*diff(log(US[,'q_gdp']/US[,'K'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
abline(h=mean(100*diff(log(US[,'q_gdp']/US[,'K']))),lty=2)
mtext("Growth rate, %", side=4, line=2.5,cex=0.7)
legend("topright",legend=c("Level","Growth rate, rhs"),lty=c(1,2),lwd=2,bty="n")
plot(US[,'q_gdp']/US[,'L'],main="Labor productivity, Y/L",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(100*diff(log(US[,'q_gdp']/US[,'L'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
abline(h=mean(100*diff(log(US[,'q_gdp']/US[,'L']))),lty=2)
mtext("Growth rate, %", side=4, line=2.5,cex=0.7)
legend("topright",legend=c("Level","Growth rate, rhs"),lty=c(1,2),lwd=2,bty="n")
par(mfrow=c(2,2),mar=c(2,4,2,4))
plot(US[,'q']/US[,'w'],main="Relative prices, q/w",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(100*diff(log(US[,'q']/US[,'w'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
abline(h=mean(100*diff(log(US[,'q']/US[,'w']))),lty=2)
mtext("Growth rate, %", side=4, line=2.5,cex=0.7)
legend("topright",legend=c("Level","Growth rate, rhs"),lty=c(1,2),lwd=2,bty="n")
plot(US[,'K']/US[,'L'],main="K/L-ratio",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(100*diff(log(US[,'K']/US[,'L'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
abline(h=mean(100*diff(log(US[,'K']/US[,'L']))),lty=2)
mtext("Growth rate, %", side=4, line=2.5,cex=0.7)
plot(US[,'q_gdp']/US[,'K'],main="Capital productivity, Y/K",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(100*diff(log(US[,'q_gdp']/US[,'K'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
abline(h=mean(100*diff(log(US[,'q_gdp']/US[,'K']))),lty=2)
mtext("Growth rate, %", side=4, line=2.5,cex=0.7)
plot(US[,'q_gdp']/US[,'L'],main="Labor productivity, Y/L",ylab="Level",xlab="",lwd=2)
par(new = TRUE)
plot(100*diff(log(US[,'q_gdp']/US[,'L'])),type="l",axes=F,ylab="",xlab="",lty=2,lwd=2)
axis(4)
abline(h=0,col="grey40")
abline(h=mean(100*diff(log(US[,'q_gdp']/US[,'L']))),lty=2)
mtext("Growth rate, %", side=4, line=2.5,cex=0.7)
data = cbind(US[,"q"],US[,"w"],US[,"K"],US[,"L"])
Estimation = CESKalman(data=data,grid.lambda = c(100,1000,100),lambda_est_freely = T)
plot(Estimation$Gamma)
plot(ts(Estimation$Gamma,start=1970,end=2016,freq=1),ylab="",xlab="",lwd=2)
Estimation$nlags
length(Estimation$Gamma)
plot(ts(Estimation$Gamma,start=1970+1,end=2016,freq=1),ylab="",xlab="",lwd=2)
install.packages("ecm")
library(ecm)
?ecm
## The target variable is:
s = log((data[,'q']*data[,'K'])/(data[,'w']*data[,'L']))
data = cbind(US[,"q"],US[,"w"],US[,"K"],US[,"L"])
## The target variable is:
s = log((data[,'q']*data[,'K'])/(data[,'w']*data[,'L']))
## The target variable is:
s = log((data[,"q"]*data[,"K"])/(data[,"w"]*data[,"L"]))
## The target variable is:
s = log((data[,1]*data[,3])/(data[,2]*data[,4]))
library(ecm)
## The relative expenditure share is:
s = log((data[,1]*data[,3])/(data[,2]*data[,4]))
## The relative prices is:
p = log(data[,1]/data[,2])
Estimation = ecm(y=s,xeq=p,xtr=p)
## The relative expenditure share is:
s = log((data[,1]*data[,3])/(data[,2]*data[,4]))
## The relative prices is:
p = data.frame(log(data[,1]/data[,2]))
Estimation = ecm(y=s,xeq=p,xtr=p)
class(s)
## The relative expenditure share is:
s = data.frame(log((data[,1]*data[,3])/(data[,2]*data[,4])))
## The relative prices is:
p = data.frame(log(data[,1]/data[,2]))
Estimation = ecm(y=s,xeq=p,xtr=p)
## The relative expenditure share is:
s = as.matrix(log((data[,1]*data[,3])/(data[,2]*data[,4])))
## The relative prices is:
p = as.matrix(log(data[,1]/data[,2]))
Estimation = ecm(y=s,xeq=p,xtr=p)
## The relative expenditure share is:
s = as.matrix(log((data[,1]*data[,3])/(data[,2]*data[,4])))
## The relative prices is:
p = data.frame(as.matrix(log(data[,1]/data[,2])))
Estimation = ecm(y=s,xeq=p,xtr=p)
Estimation$coefficients
summary(Estimation$coefficients)
Estimation = lm(diff(s)~s[-length(s)]+p[-length(p)]+diff(p))
length(p)
## The relative expenditure share is:
s = as.matrix(log((data[,1]*data[,3])/(data[,2]*data[,4])))
## The relative prices is:
p = as.matrix(log(data[,1]/data[,2]))
Estimation = lm(diff(s)~s[-length(s)]+p[-length(p)]+diff(p))
summary(Estimation)
plot(Estimation$residuals)
?ecm
Estimation = summary(ecm(y=s,xeq=p,xtr=p,lags=2))
## Estimate as an error-correction with harrod-neutral technical change
Est_HN = lm(diff(s)~s[-length(s)]+p[-length(p)]+diff(p))
Est_HN$coefficients
Significant error-correction. The adjustment parameter is `r Est_HN$coefficients[2]` The long run elasticity is `r -Est_HN$coefficients[3]/Est_HN$coefficients[2]`
## Long run elasticity is
print(-Est_HN$coefficients[3]/Est_HN$coefficients[2]+1)
t = 1:(length(s)-1)
## Estimate as an error-correction with harrod-neutral technical change
Est_Harrod = summary(lm(diff(s)~s[-length(s)]+p[-length(p)]+diff(p))+t)
s
p
t
class(t)
t = as.numeric(1:(length(s)-1))
## Estimate as an error-correction with harrod-neutral technical change
Est_Harrod = summary(lm(diff(s)~s[-length(s)]+p[-length(p)]+diff(p))+t)
class(t)
t
t = as.numeric(1:(length(s)-1))
## Estimate as an error-correction with harrod-neutral technical change
Est_Harrod = summary(lm(diff(s)~s[-length(s)]+p[-length(p)]+diff(p))+t)
t = as.numeric(1:(length(s)-1))
## Estimate as an error-correction with harrod-neutral technical change
Est_Harrod = summary(lm(diff(s)~s[-length(s)]+p[-length(p)]+diff(p))+t)
t = as.vector(1:(length(s)-1))
## Estimate as an error-correction with harrod-neutral technical change
Est_Harrod = summary(lm(diff(s)~s[-length(s)]+p[-length(p)]+diff(p))+t)
t
s
p
t = as.matrix(1:(length(s)-1))
## Estimate as an error-correction with harrod-neutral technical change
Est_Harrod = summary(lm(diff(s)~s[-length(s)]+p[-length(p)]+diff(p))+t)
t = 1:47
## Estimate as an error-correction with harrod-neutral technical change
Est_Harrod = summary(lm(diff(s)~s[-length(s)]+p[-length(p)]+diff(p))+t)
## Estimate as an error-correction with harrod-neutral technical change
Est_Harrod = summary(lm(diff(s)~s[-length(s)]+p[-length(p)]+diff(p))+1:47)
t = ts(1:47,start=1971,end=2017,freq=1)
## Estimate as an error-correction with harrod-neutral technical change
Est_Harrod = summary(lm(diff(s)~s[-length(s)]+p[-length(p)]+diff(p)+t))
Est_Harrod$coefficients
-Est_Harrod$coefficients[3]/Est_Harrod$coefficients[2]+1
-Est_Harrod$coefficients[4]/Est_Harrod$coefficients[2]
-Est_Harrod$coefficients[5]/Est_Harrod$coefficients[2]
t = ts(1:47,start=1971,end=2017,freq=1)
t2 = t^2
t3 = t^3
## Estimate as an error-correction with harrod-neutral technical change
Est_Harrod = summary(lm(diff(s)~s[-length(s)]+p[-length(p)]+diff(p)+t+t2+t3))
Est_Harrod
-Est_Harrod$coefficients[3]/Est_Harrod$coefficients[2]+1
t = ts(1:47,start=1971,end=2017,freq=1)
t2 = t^2
t3 = t^3
## Estimate as an error-correction with harrod-neutral technical change
Est_Poly = summary(lm(diff(s)~s[-length(s)]+p[-length(p)]+diff(p)+t+t2+t3))
## The process of technical change is:
tech = -(t*Est_Poly$coefficients[5]+t2*Est_Poly$coefficients[6]+t3*Est_Poly$coefficients[7])/Est_Poly
Est_Poly$coefficients
Est_Poly$coefficients[4]
Est_Poly$coefficients[5]
Est_Poly$coefficients[5]*t
## The process of technical change is:
tech = -(t*Est_Poly$coefficients[5]+t2*Est_Poly$coefficients[6]+t3*Est_Poly$coefficients[7])/Est_Poly$coefficients[2]
plot(tech)
t = ts(1:47,start=1971,end=2017,freq=1)
t2 = t^2
t3 = t^3
t4 = t^4
## Estimate as an error-correction with harrod-neutral technical change
Est_Poly = summary(lm(diff(s)~s[-length(s)]+p[-length(p)]+diff(p)+t+t2+t3+t4))
## The process of technical change is:
tech = -(t*Est_Poly$coefficients[5]+t2*Est_Poly$coefficients[6]+t3*Est_Poly$coefficients[7]
+t4*Est_Poly$coefficients[8])/Est_Poly$coefficients[2]
plot(tech)
plot(-(Est_Harrod$coefficients[5]*t)/Est_Harrod$coefficients[2])
## The process of technical change is:
tech = -(t*Est_Poly$coefficients[5]+t2*Est_Poly$coefficients[6]+t3*Est_Poly$coefficients[7]
+t4*Est_Poly$coefficients[8])/Est_Poly$coefficients[2]
plot(tech,ylab="",xlab="",main="Relative technical change, higher order polynomia")
plot(Estimation,t0=1970+Estimation$nlags,tEnd=2017)
Estimation = CESKalman(data=data,grid.lambda = c(100,100,100),lambda_est_freely = F)
plot(Estimation,t0=1970+Estimation$nlags,tEnd=2017)
Estimation_10 = CESKalman(data=data,grid.lambda = c(10,10,100),lambda_est_freely = F)
Estimation_100 = CESKalman(data=data,grid.lambda = c(100,100,100),lambda_est_freely = F)
Estimation_500 = CESKalman(data=data,grid.lambda = c(500,500,100),lambda_est_freely = F)
Estimation_10000 = CESKalman(data=data,grid.lambda = c(10000,10000,100),lambda_est_freely = F)
Estimation_10$nlags
Estimation_100$nlags
Estimation_10000$nlags
Estimation_10 = CESKalman(data=data,grid.lambda = c(10,10,100),lambda_est_freely = F,max_nlags = 0)
Estimation_100 = CESKalman(data=data,grid.lambda = c(100,100,100),lambda_est_freely = F,max_nlags = 0)
Estimation_500 = CESKalman(data=data,grid.lambda = c(500,500,100),lambda_est_freely = F,max_nlags = 0)
Estimation_10000 = CESKalman(data=data,grid.lambda = c(10000,10000,100),lambda_est_freely = F,max_nlags = 0)
Estimation_10 = CESKalman(data=data,grid.lambda = c(10,10,100),lambda_est_freely = F)
Estimation_100 = CESKalman(data=data,grid.lambda = c(100,100,100),lambda_est_freely = F)
Estimation_500 = CESKalman(data=data,grid.lambda = c(500,500,100),lambda_est_freely = F)
Estimation_10000 = CESKalman(data=data,grid.lambda = c(10000,10000,100),lambda_est_freely = F)
plot(ts(Estimation_10$Gamma,start=1970+Estimation$nlags,end=2016,freq=1),ylab="",xlab="",lwd=2
,main=paste("The elasticity is ",round(Estimation$sigma,2),sep=""))
lines(ts(Estimation_100$Gamma,start=1970+Estimation$nlags,end=2016,freq=1),lty=2,lwd=2)
plot(ts(Estimation_10$Gamma,start=1970+Estimation_10$nlags,end=2016,freq=1),ylab="",xlab="",lwd=2
,main=paste("The elasticity is ",round(Estimation$sigma,2),sep=""))
lines(ts(Estimation_100$Gamma,start=1970+Estimation_100$nlags,end=2016,freq=1),lty=2,lwd=2)
ylim = c(Estimation_10$Gamma,Estimation_100$Gamma,Estimation_500$Gamma,Estimation_10000$Gamma)
ylim=range(ylim)
ylim
ylim = c(Estimation_10$Gamma,Estimation_100$Gamma,Estimation_500$Gamma,Estimation_10000$Gamma)
plot(ts(Estimation_10$Gamma,start=1970+Estimation_10$nlags,end=2016,freq=1),ylab="",xlab="",lwd=2
,ylim=range(ylim))
lines(ts(Estimation_100$Gamma,start=1970+Estimation_100$nlags,end=2016,freq=1),lty=2,lwd=2)
ylim = c(Estimation_10$Gamma,Estimation_100$Gamma,Estimation_500$Gamma,Estimation_10000$Gamma)
plot(ts(Estimation_10$Gamma,start=1970+Estimation_10$nlags,end=2016,freq=1),ylab="",xlab="",lwd=2
,ylim=range(ylim))
lines(ts(Estimation_100$Gamma,start=1970+Estimation_100$nlags,end=2016,freq=1),lty=2,lwd=2)
lines(ts(Estimation_500$Gamma,start=1970+Estimation_100$nlags,end=2016,freq=1),lty=2,lwd=2)
lines(ts(Estimation_10000$Gamma,start=1970+Estimation_100$nlags,end=2016,freq=1),lty=2,lwd=2)
ylim = c(Estimation_10$Gamma,Estimation_100$Gamma,Estimation_500$Gamma,Estimation_10000$Gamma)
plot(ts(Estimation_10$Gamma,start=1970+Estimation_10$nlags,end=2016,freq=1),ylab="",xlab="",lwd=2
,ylim=range(ylim))
lines(ts(Estimation_100$Gamma,start=1970+Estimation_100$nlags,end=2016,freq=1),lty=2,lwd=2)
lines(ts(Estimation_500$Gamma,start=1970+Estimation_500$nlags,end=2016,freq=1),lty=2,lwd=2)
lines(ts(Estimation_10000$Gamma,start=1970+Estimation_10000$nlags,end=2016,freq=1),lty=2,lwd=2)
ylim = c(Estimation_10$Gamma,Estimation_100$Gamma,Estimation_500$Gamma,Estimation_10000$Gamma)
plot(ts(Estimation_10$Gamma,start=1970+Estimation_10$nlags,end=2016,freq=1),ylab="",xlab="",lwd=2
,ylim=range(ylim))
lines(ts(Estimation_100$Gamma,start=1970+Estimation_100$nlags,end=2016,freq=1),lty=2,lwd=2)
lines(ts(Estimation_500$Gamma,start=1970+Estimation_500$nlags,end=2016,freq=1),lty=3,lwd=2)
lines(ts(Estimation_10000$Gamma,start=1970+Estimation_10000$nlags,end=2016,freq=1),lty=4,lwd=2)
Estimation_10 = CESKalman(data=data,grid.lambda = c(10,10,100),lambda_est_freely = F,max_nlags = 0)
Estimation_100 = CESKalman(data=data,grid.lambda = c(100,100,100),lambda_est_freely = F,max_nlags = 0)
Estimation_500 = CESKalman(data=data,grid.lambda = c(500,500,100),lambda_est_freely = F,max_nlags = 0)
Estimation_10000 = CESKalman(data=data,grid.lambda = c(10000,10000,100),lambda_est_freely = F,max_nlags = 0)
ylim = c(Estimation_10$Gamma,Estimation_100$Gamma,Estimation_500$Gamma,Estimation_10000$Gamma)
plot(ts(Estimation_10$Gamma,start=1970+Estimation_10$nlags,end=2016,freq=1),ylab="",xlab="",lwd=2
,ylim=range(ylim))
lines(ts(Estimation_100$Gamma,start=1970+Estimation_100$nlags,end=2016,freq=1),lty=2,lwd=2)
lines(ts(Estimation_500$Gamma,start=1970+Estimation_500$nlags,end=2016,freq=1),lty=3,lwd=2)
lines(ts(Estimation_10000$Gamma,start=1970+Estimation_10000$nlags,end=2016,freq=1),lty=4,lwd=2)
ylim = c(Estimation_100$Gamma,Estimation_500$Gamma,Estimation_1000$Gamma,Estimation_10000$Gamma)
?CESKalman_Bootstrap
